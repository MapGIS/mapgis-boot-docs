(window.webpackJsonp=window.webpackJsonp||[]).push([[10],{290:function(a,s,t){"use strict";t.r(s);var e=t(3),n=Object(e.a)({},(function(){var a=this,s=a._self._c;return s("ContentSlotsDistributor",{attrs:{"slot-key":a.$parent.slotKey}},[s("h1",{attrs:{id:"部署运行"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#部署运行"}},[a._v("#")]),a._v(" 部署运行")]),a._v(" "),s("h2",{attrs:{id:"传统部署"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#传统部署"}},[a._v("#")]),a._v(" 传统部署")]),a._v(" "),s("h3",{attrs:{id:"单体版"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#单体版"}},[a._v("#")]),a._v(" 单体版")]),a._v(" "),s("h4",{attrs:{id:"安装"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#安装"}},[a._v("#")]),a._v(" 安装")]),a._v(" "),s("p",[a._v("将与服务器架构一致的单体版包放到服务器的某一目录。")]),a._v(" "),s("h4",{attrs:{id:"调整参数"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#调整参数"}},[a._v("#")]),a._v(" 调整参数")]),a._v(" "),s("p",[a._v("复制 config/application.example.properties 文件并命名为 application.properties，修改里面的服务端口和数据源等信息。")]),a._v(" "),s("blockquote",[s("p",[a._v("如果某项配置为中文，可额外通过application.yml文件进行补充配置")])]),a._v(" "),s("h4",{attrs:{id:"启动运行"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#启动运行"}},[a._v("#")]),a._v(" 启动运行")]),a._v(" "),s("div",{staticClass:"language-shell extra-class"},[s("pre",{pre:!0,attrs:{class:"language-shell"}},[s("code",[s("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# win-x86_64启动")]),a._v("\nbin/startup.bat\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# linx-x86_64启动")]),a._v("\nbin/startup.sh\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# linx-x86_64停止")]),a._v("\nbin/shutdown.sh\n")])])]),s("h4",{attrs:{id:"访问应用"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#访问应用"}},[a._v("#")]),a._v(" 访问应用")]),a._v(" "),s("p",[s("a",{attrs:{href:"http://%7BHOST_IP%7D:%7BAPP_PORT%7D",target:"_blank",rel:"noopener noreferrer"}},[a._v("http://{HOST_IP}:{APP_PORT}"),s("OutboundLink")],1)]),a._v(" "),s("p",[a._v("{HOST_IP}为应用所在主机的IP，{APP_PORT}为应用端口")]),a._v(" "),s("h3",{attrs:{id:"微服务版"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#微服务版"}},[a._v("#")]),a._v(" 微服务版")]),a._v(" "),s("blockquote",[s("p",[a._v("因微服务版涉及到服务较多，不推荐采用传统方式进行部署，建议采用容器部署方式（Docker Compose或Kubernetes）")])]),a._v(" "),s("h4",{attrs:{id:"安装前提"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#安装前提"}},[a._v("#")]),a._v(" 安装前提")]),a._v(" "),s("ul",[s("li",[a._v("redis【必须】")]),a._v(" "),s("li",[a._v("mysql【必须】")]),a._v(" "),s("li",[a._v("nacos【必须】")]),a._v(" "),s("li",[a._v("sentinel【可选】")])]),a._v(" "),s("h4",{attrs:{id:"安装-2"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#安装-2"}},[a._v("#")]),a._v(" 安装")]),a._v(" "),s("p",[a._v("将与服务器架构一致的微服务版包放到服务器的某一目录，并配置微服务版应用所在主机本地hosts：")]),a._v(" "),s("div",{staticClass:"language-shell extra-class"},[s("pre",{pre:!0,attrs:{class:"language-shell"}},[s("code",[s("span",{pre:!0,attrs:{class:"token number"}},[a._v("127.0")]),a._v(".0.1 mapgis-xxx-mysql\n"),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("127.0")]),a._v(".0.1 mapgis-xxx-redis\n"),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("127.0")]),a._v(".0.1 mapgis-xxx-nacos\n"),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("127.0")]),a._v(".0.1 mapgis-xxx-sentinel\n"),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("127.0")]),a._v(".0.1 mapgis-xxx-gateway\n")])])]),s("h4",{attrs:{id:"调整参数-2"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#调整参数-2"}},[a._v("#")]),a._v(" 调整参数")]),a._v(" "),s("p",[a._v("微服务版配置在配置中心nacos中，需要进入到nacos中进行调整，比如：redis密码、mysql数据源信息等")]),a._v(" "),s("h4",{attrs:{id:"启动运行-2"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#启动运行-2"}},[a._v("#")]),a._v(" 启动运行")]),a._v(" "),s("div",{staticClass:"language-shell extra-class"},[s("pre",{pre:!0,attrs:{class:"language-shell"}},[s("code",[s("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# win-x86_64启动")]),a._v("\nbin/startup.bat\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# linx-x86_64启动")]),a._v("\nbin/startup.sh\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# linx-x86_64停止")]),a._v("\nbin/shutdown.sh\n")])])]),s("h4",{attrs:{id:"访问应用-2"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#访问应用-2"}},[a._v("#")]),a._v(" 访问应用")]),a._v(" "),s("p",[s("a",{attrs:{href:"http://%7BHOST_IP%7D:%7BGATEWAY_PUBLIC_PORT%7D",target:"_blank",rel:"noopener noreferrer"}},[a._v("http://{HOST_IP}:{GATEWAY_PUBLIC_PORT}"),s("OutboundLink")],1)]),a._v(" "),s("p",[a._v("{HOST_IP}为应用所在主机的IP，{GATEWAY_PUBLIC_PORT}为应用端口")]),a._v(" "),s("h2",{attrs:{id:"docker-compose部署"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#docker-compose部署"}},[a._v("#")]),a._v(" Docker Compose部署")]),a._v(" "),s("h3",{attrs:{id:"安装docker和docker-compose"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#安装docker和docker-compose"}},[a._v("#")]),a._v(" 安装Docker和Docker Compose")]),a._v(" "),s("p",[a._v("安装Docker")]),a._v(" "),s("div",{staticClass:"language-shell extra-class"},[s("pre",{pre:!0,attrs:{class:"language-shell"}},[s("code",[s("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# 使用daocloud 的一键安装脚本")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token function"}},[a._v("curl")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-sSL")]),a._v(" https://get.daocloud.io/docker "),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("|")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[a._v("sh")]),a._v("\n\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# 安装 daocloud 加速器，避免dockerhub 网络问题")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token function"}},[a._v("curl")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-sSL")]),a._v(" https://get.daocloud.io/daotools/set_mirror.sh "),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("|")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[a._v("sh")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-s")]),a._v(" http://f1361db2.m.daocloud.io\n\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# 启动docker服务")]),a._v("\nsystemctl start "),s("span",{pre:!0,attrs:{class:"token function"}},[a._v("docker")]),a._v("\n\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# 测试运行 hello-world,由于本地没有hello-world这个镜像，所以会下载一个hello-world的镜像，并在容器内运行。")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token function"}},[a._v("docker")]),a._v(" run hello-world\n\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# 查看Docker版本")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token function"}},[a._v("docker")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("--version")]),a._v("\n")])])]),s("p",[a._v("安装Docker Compose")]),a._v(" "),s("div",{staticClass:"language-shell extra-class"},[s("pre",{pre:!0,attrs:{class:"language-shell"}},[s("code",[s("span",{pre:!0,attrs:{class:"token function"}},[a._v("curl")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-L")]),a._v(" https://get.daocloud.io/docker/compose/releases/download/1.29.2/docker-compose-"),s("span",{pre:!0,attrs:{class:"token variable"}},[s("span",{pre:!0,attrs:{class:"token variable"}},[a._v("`")]),s("span",{pre:!0,attrs:{class:"token function"}},[a._v("uname")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-s")]),s("span",{pre:!0,attrs:{class:"token variable"}},[a._v("`")])]),a._v("-"),s("span",{pre:!0,attrs:{class:"token variable"}},[s("span",{pre:!0,attrs:{class:"token variable"}},[a._v("`")]),s("span",{pre:!0,attrs:{class:"token function"}},[a._v("uname")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-m")]),s("span",{pre:!0,attrs:{class:"token variable"}},[a._v("`")])]),a._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v(">")]),a._v(" /usr/local/bin/docker-compose\n"),s("span",{pre:!0,attrs:{class:"token function"}},[a._v("chmod")]),a._v(" +x /usr/local/bin/docker-compose\n")])])]),s("h3",{attrs:{id:"配置私有镜像仓库"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#配置私有镜像仓库"}},[a._v("#")]),a._v(" 配置私有镜像仓库")]),a._v(" "),s("p",[a._v("目前MapGIS Boot已上传到私有镜像仓库192.168.177.1:5000，需要配置Docker")]),a._v(" "),s("div",{staticClass:"language-shell extra-class"},[s("pre",{pre:!0,attrs:{class:"language-shell"}},[s("code",[s("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# 编辑")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token function"}},[a._v("vi")]),a._v(" /etc/docker/daemon.json\n\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# 添加私有仓库地址")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("{")]),a._v("\n  "),s("span",{pre:!0,attrs:{class:"token string"}},[a._v('"registry-mirrors"')]),s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[a._v(":")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("[")]),s("span",{pre:!0,attrs:{class:"token string"}},[a._v('"加速地址"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("]")]),a._v(",\n  "),s("span",{pre:!0,attrs:{class:"token string"}},[a._v('"insecure-registries"')]),s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[a._v(":")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("[")]),s("span",{pre:!0,attrs:{class:"token string"}},[a._v('"192.168.177.1:5000"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("]")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("}")]),a._v("\n\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# 生效")]),a._v("\nsystemctl daemon-reload\nsystemctl restart "),s("span",{pre:!0,attrs:{class:"token function"}},[a._v("docker")]),a._v("\n")])])]),s("h3",{attrs:{id:"单体版-2"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#单体版-2"}},[a._v("#")]),a._v(" 单体版")]),a._v(" "),s("h4",{attrs:{id:"安装-3"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#安装-3"}},[a._v("#")]),a._v(" 安装")]),a._v(" "),s("p",[a._v("将Docker版的包放到linux服务器的某一目录，如："),s("code",[a._v("/opt")]),a._v("，进入应用根目录，执行以下命令，进行安装：")]),a._v(" "),s("div",{staticClass:"language-shell extra-class"},[s("pre",{pre:!0,attrs:{class:"language-shell"}},[s("code",[s("span",{pre:!0,attrs:{class:"token function"}},[a._v("sudo")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[a._v("chmod")]),a._v(" +x install.sh "),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("&&")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[a._v("sudo")]),a._v(" ./install.sh\n")])])]),s("h4",{attrs:{id:"调整参数-3"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#调整参数-3"}},[a._v("#")]),a._v(" 调整参数")]),a._v(" "),s("p",[a._v("编辑"),s("code",[a._v(".env")]),a._v("，根据需要修改相关参数，运行"),s("code",[a._v("sudo vi .env")])]),a._v(" "),s("div",{staticClass:"language-properties extra-class"},[s("pre",{pre:!0,attrs:{class:"language-properties"}},[s("code",[s("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# 私有镜像仓库地址，注意结尾需含/，默认为空")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token key attr-name"}},[a._v("DOCKER_REGISTRY_URL")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("=")]),a._v("\n\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# 镜像标签")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token key attr-name"}},[a._v("MAPGIS_IMAGE_TAG")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("=")]),s("span",{pre:!0,attrs:{class:"token value attr-value"}},[a._v("10.6.6.10")]),a._v("\n\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# 应用端口")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token key attr-name"}},[a._v("MAPGIS_APP_PORT")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("=")]),s("span",{pre:!0,attrs:{class:"token value attr-value"}},[a._v("8080")]),a._v("\n")])])]),s("h4",{attrs:{id:"启动运行-3"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#启动运行-3"}},[a._v("#")]),a._v(" 启动运行")]),a._v(" "),s("div",{staticClass:"language-shell extra-class"},[s("pre",{pre:!0,attrs:{class:"language-shell"}},[s("code",[s("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# 启动")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token function"}},[a._v("sudo")]),a._v(" ./startup.sh\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# 停止")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token function"}},[a._v("sudo")]),a._v(" ./shutdown.sh\n")])])]),s("h4",{attrs:{id:"访问应用-3"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#访问应用-3"}},[a._v("#")]),a._v(" 访问应用")]),a._v(" "),s("p",[s("a",{attrs:{href:"http://%7BDOCKER_HOST_IP%7D:%7BMAPGIS_APP_PORT%7D",target:"_blank",rel:"noopener noreferrer"}},[a._v("http://{DOCKER_HOST_IP}:{MAPGIS_APP_PORT}"),s("OutboundLink")],1)]),a._v(" "),s("p",[a._v("{DOCKER_HOST_IP}为Docker宿主机的IP，{MAPGIS_APP_PORT}为应用端口")]),a._v(" "),s("h3",{attrs:{id:"微服务版-2"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#微服务版-2"}},[a._v("#")]),a._v(" 微服务版")]),a._v(" "),s("h4",{attrs:{id:"安装-4"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#安装-4"}},[a._v("#")]),a._v(" 安装")]),a._v(" "),s("p",[a._v("将Docker版的包放到linux服务器的某一目录，如："),s("code",[a._v("/opt")]),a._v("，进入应用根目录，执行以下命令，进行安装：")]),a._v(" "),s("div",{staticClass:"language-shell extra-class"},[s("pre",{pre:!0,attrs:{class:"language-shell"}},[s("code",[s("span",{pre:!0,attrs:{class:"token function"}},[a._v("sudo")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[a._v("chmod")]),a._v(" +x install.sh "),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("&&")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[a._v("sudo")]),a._v(" ./install.sh\n")])])]),s("h4",{attrs:{id:"调整参数-4"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#调整参数-4"}},[a._v("#")]),a._v(" 调整参数")]),a._v(" "),s("p",[a._v("编辑"),s("code",[a._v(".env")]),a._v("，根据需要修改相关参数，运行"),s("code",[a._v("sudo vi .env")])]),a._v(" "),s("div",{staticClass:"language-properties extra-class"},[s("pre",{pre:!0,attrs:{class:"language-properties"}},[s("code",[s("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# 私有镜像仓库地址，注意结尾需含/，默认为空")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token key attr-name"}},[a._v("DOCKER_REGISTRY_URL")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("=")]),a._v("\n\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# 镜像标签")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token key attr-name"}},[a._v("MAPGIS_IMAGE_TAG")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("=")]),s("span",{pre:!0,attrs:{class:"token value attr-value"}},[a._v("10.6.6.10")]),a._v("\n\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# NACOS主机(用于微服务之间通信，一般不需要修改)")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token key attr-name"}},[a._v("NACOS_HOST")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("=")]),s("span",{pre:!0,attrs:{class:"token value attr-value"}},[a._v("mapgis-xxx-nacos")]),a._v("\n\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# NACOS端口(内部端口，用于微服务之间通信，一般不需要修改)")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token key attr-name"}},[a._v("NACOS_PORT")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("=")]),s("span",{pre:!0,attrs:{class:"token value attr-value"}},[a._v("8848")]),a._v("\n\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# 网关主机(用于微服务之间通信，一般不需要修改)")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token key attr-name"}},[a._v("GATEWAY_HOST")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("=")]),s("span",{pre:!0,attrs:{class:"token value attr-value"}},[a._v("mapgis-xxx-gateway")]),a._v("\n\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# 网关主机(外部主机，用于Swagger在线文档，需要外部能访问，如不能访问，请设置成Docker宿主机IP)")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token key attr-name"}},[a._v("GATEWAY_PUBLIC_HOST")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("=")]),a._v("\n\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# 网关端口(外部端口，用于应用入口和Swagger在线文档)")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token key attr-name"}},[a._v("GATEWAY_PUBLIC_PORT")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("=")]),s("span",{pre:!0,attrs:{class:"token value attr-value"}},[a._v("8080")]),a._v("\n\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# Redis主机(用于微服务之间通信，一般不需要修改)")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token key attr-name"}},[a._v("REDIS_HOST")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("=")]),s("span",{pre:!0,attrs:{class:"token value attr-value"}},[a._v("mapgis-xxx-redis")]),a._v("\n\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# Redis端口(内部端口，用于微服务之间通信，一般不需要修改)")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token key attr-name"}},[a._v("REDIS_PORT")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("=")]),s("span",{pre:!0,attrs:{class:"token value attr-value"}},[a._v("6379")]),a._v("\n\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# Redis密码(可修改)")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token key attr-name"}},[a._v("REDIS_PWD")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("=")]),s("span",{pre:!0,attrs:{class:"token value attr-value"}},[a._v("cloud123.mapgis")]),a._v("\n\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# MySQL主机(用于微服务之间通信，一般不需要修改)")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token key attr-name"}},[a._v("MYSQL_HOST")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("=")]),s("span",{pre:!0,attrs:{class:"token value attr-value"}},[a._v("mapgis-xxx-mysql")]),a._v("\n\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# MySQL端口(内部端口，用于微服务之间通信，一般不需要修改)")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token key attr-name"}},[a._v("MYSQL_PORT")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("=")]),s("span",{pre:!0,attrs:{class:"token value attr-value"}},[a._v("3306")]),a._v("\n\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# MySQL数据库名(默认由容器创建，一般不需要修改)")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token key attr-name"}},[a._v("MYSQL_DB")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("=")]),s("span",{pre:!0,attrs:{class:"token value attr-value"}},[a._v("mapgis-cloud-xxx")]),a._v("\n\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# MySQL配置中心数据库名(由配置中心sql脚本自动创建，一般不需要修改)")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token key attr-name"}},[a._v("MYSQL_CONFIG_DB")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("=")]),s("span",{pre:!0,attrs:{class:"token value attr-value"}},[a._v("mapgis-cloud-config")]),a._v("\n\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# MySQL用户名")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token key attr-name"}},[a._v("MYSQL_USER")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("=")]),s("span",{pre:!0,attrs:{class:"token value attr-value"}},[a._v("root")]),a._v("\n\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# MySQL密码(可修改)")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token key attr-name"}},[a._v("MYSQL_PWD")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("=")]),s("span",{pre:!0,attrs:{class:"token value attr-value"}},[a._v("cloud123.mapgis")]),a._v("\n\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# MONITOR端口(外部端口，用于Spring Boot应用监控，需要外部能访问)")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token key attr-name"}},[a._v("MONITOR_PUBLIC_PORT")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("=")]),s("span",{pre:!0,attrs:{class:"token value attr-value"}},[a._v("9200")]),a._v("\n")])])]),s("h4",{attrs:{id:"启动运行-4"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#启动运行-4"}},[a._v("#")]),a._v(" 启动运行")]),a._v(" "),s("div",{staticClass:"language-shell extra-class"},[s("pre",{pre:!0,attrs:{class:"language-shell"}},[s("code",[s("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# 启动")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token function"}},[a._v("sudo")]),a._v(" ./startup.sh\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# 停止")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token function"}},[a._v("sudo")]),a._v(" ./shutdown.sh\n")])])]),s("h4",{attrs:{id:"访问应用-4"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#访问应用-4"}},[a._v("#")]),a._v(" 访问应用")]),a._v(" "),s("p",[s("a",{attrs:{href:"http://%7BDOCKER_HOST_IP%7D:%7BGATEWAY_PUBLIC_PORT%7D",target:"_blank",rel:"noopener noreferrer"}},[a._v("http://{DOCKER_HOST_IP}:{GATEWAY_PUBLIC_PORT}"),s("OutboundLink")],1)]),a._v(" "),s("p",[a._v("{DOCKER_HOST_IP}为Docker宿主机的IP，{GATEWAY_PUBLIC_PORT}为应用端口")]),a._v(" "),s("h2",{attrs:{id:"kubernetes部署"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#kubernetes部署"}},[a._v("#")]),a._v(" Kubernetes部署")]),a._v(" "),s("h3",{attrs:{id:"安装前提-2"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#安装前提-2"}},[a._v("#")]),a._v(" 安装前提")]),a._v(" "),s("ul",[s("li",[s("p",[a._v("Kubernetes 1.9及以上")])]),a._v(" "),s("li",[s("p",[a._v("所需硬件资源")]),a._v(" "),s("ul",[s("li",[s("p",[a._v("CPU：4核")])]),a._v(" "),s("li",[s("p",[a._v("内存：16GB+")])]),a._v(" "),s("li",[s("p",[a._v("硬盘：200GB+")])])])]),a._v(" "),s("li",[s("p",[a._v("NFS Server")])]),a._v(" "),s("li",[s("p",[a._v("私有镜像仓库（如果可以访问阿里云镜像仓库，则不需要搭建）")]),a._v(" "),s("blockquote",[s("p",[a._v("搭建时可参考"),s("RouterLink",{attrs:{to:"/zh/guide/document/deploy.html#配置私有镜像仓库"}},[a._v("配置私有镜像仓库")])],1)])])]),a._v(" "),s("h3",{attrs:{id:"单体版-3"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#单体版-3"}},[a._v("#")]),a._v(" 单体版")]),a._v(" "),s("h4",{attrs:{id:"调整参数-5"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#调整参数-5"}},[a._v("#")]),a._v(" 调整参数")]),a._v(" "),s("p",[a._v("编辑"),s("code",[a._v("values.yaml")]),a._v("，根据需要修改相关参数，运行"),s("code",[a._v("sudo vi values.yaml")])]),a._v(" "),s("div",{staticClass:"language-shell extra-class"},[s("pre",{pre:!0,attrs:{class:"language-shell"}},[s("code",[s("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# 选填，应用端口，自定义范围30000-32767，默认为32000")]),a._v("\nappPort: "),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("32000")]),a._v("\n\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# 必填，镜像仓库地址，默认为阿里云镜像仓库（外网推荐使用）：registry.cn-beijing.aliyuncs.com")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# 内网私有镜像仓库：<ip>:5000，<ip>为镜像仓库所在的机器IP，例如：192.168.177.1:5000")]),a._v("\nimageRegistry: \n\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# 必填，NFS Server的地址，用于持久化存储应用数据，例如：192.168.130.10")]),a._v("\nnfsServer: \n\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# 必填，NFS Server提供的挂载路径，默认是根路径: /，请根据实际情况填写，例如：/nfs/data")]),a._v("\nnfsPath: /\n\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# 选填，用于存储应用数据，它跟NFS Server都用于存储数据，如果和NFS Server同时存在，优先使用NFS Server存储应用数据")]),a._v("\nnfsStorageClassName: \n")])])]),s("h4",{attrs:{id:"启动运行-5"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#启动运行-5"}},[a._v("#")]),a._v(" 启动运行")]),a._v(" "),s("div",{staticClass:"language-shell extra-class"},[s("pre",{pre:!0,attrs:{class:"language-shell"}},[s("code",[s("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# 启动")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token function"}},[a._v("sudo")]),a._v(" ./startup.sh\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# 停止")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token function"}},[a._v("sudo")]),a._v(" ./shutdown.sh\n")])])]),s("h4",{attrs:{id:"访问应用-5"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#访问应用-5"}},[a._v("#")]),a._v(" 访问应用")]),a._v(" "),s("p",[s("a",{attrs:{href:"http://%7Bip%7D:%7BappPort%7D",target:"_blank",rel:"noopener noreferrer"}},[a._v("http://{ip}:{appPort}}"),s("OutboundLink")],1)]),a._v(" "),s("p",[a._v("{ip}为外部访问k8s的IP，{appPort}为应用端口")]),a._v(" "),s("h3",{attrs:{id:"微服务版-3"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#微服务版-3"}},[a._v("#")]),a._v(" 微服务版")]),a._v(" "),s("h4",{attrs:{id:"调整参数-6"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#调整参数-6"}},[a._v("#")]),a._v(" 调整参数")]),a._v(" "),s("p",[a._v("编辑"),s("code",[a._v("values.yaml")]),a._v("，根据需要修改相关参数，运行"),s("code",[a._v("sudo vi values.yaml")])]),a._v(" "),s("div",{staticClass:"language-shell extra-class"},[s("pre",{pre:!0,attrs:{class:"language-shell"}},[s("code",[s("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# 必填，外部访问k8s的IP，可以是k8s集群内任意一台外部可访问的机器IP，如：192.168.130.10")]),a._v("\nk8sPublicIp: \n\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# 选填，应用端口，自定义范围30000-32767，默认为32000")]),a._v("\nappPort: "),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("32000")]),a._v("\n\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# 必填，镜像仓库地址，默认为阿里云镜像仓库（外网推荐使用）：registry.cn-beijing.aliyuncs.com")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# 内网私有镜像仓库：<ip>:5000，<ip>为镜像仓库所在的机器IP，例如：192.168.177.1:5000")]),a._v("\nimageRegistry: \n\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# 必填，NFS Server的地址，用于持久化存储应用数据，例如：192.168.130.10")]),a._v("\nnfsServer: \n\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# 必填，NFS Server提供的挂载路径，默认是根路径: /，请根据实际情况填写，例如：/nfs/data")]),a._v("\nnfsPath: /\n\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# 选填，用于存储应用数据，它跟NFS Server都用于存储数据，如果和NFS Server同时存在，优先使用NFS Server存储应用数据")]),a._v("\nnfsStorageClassName: \n")])])]),s("h4",{attrs:{id:"启动运行-6"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#启动运行-6"}},[a._v("#")]),a._v(" 启动运行")]),a._v(" "),s("div",{staticClass:"language-shell extra-class"},[s("pre",{pre:!0,attrs:{class:"language-shell"}},[s("code",[s("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# 启动")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token function"}},[a._v("sudo")]),a._v(" ./startup.sh\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# 停止")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token function"}},[a._v("sudo")]),a._v(" ./shutdown.sh\n")])])]),s("h4",{attrs:{id:"访问应用-6"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#访问应用-6"}},[a._v("#")]),a._v(" 访问应用")]),a._v(" "),s("p",[s("a",{attrs:{href:"http://%7Bip%7D:%7BappPort%7D",target:"_blank",rel:"noopener noreferrer"}},[a._v("http://{ip}:{appPort}}"),s("OutboundLink")],1)]),a._v(" "),s("p",[a._v("{ip}为外部访问k8s的IP，{appPort}为应用端口")])])}),[],!1,null,null,null);s.default=n.exports}}]);